<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>umontreal::ssj::gof Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="ssj.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
    <td style="padding-left: 0.5em;">
    <div id="projectbrief">Stochastic Simulation in Java</div>
    </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><b>umontreal</b></li><li class="navelem"><b>ssj</b></li><li class="navelem"><a class="el" href="namespaceumontreal_1_1ssj_1_1gof.html">gof</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a>  </div>
  <div class="headertitle">
<div class="title">umontreal::ssj::gof Namespace Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Goodness-of-fit test Statistics.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classumontreal_1_1ssj_1_1gof_1_1FBar.html">FBar</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">This class is similar to <a class="el" href="classumontreal_1_1ssj_1_1gof_1_1FDist.html">FDist</a>, except that it provides static methods to compute or approximate the complementary distribution function of \(X\), which we define as \(\bar{F} (x) = P[X\ge x]\), instead of \(F (x)=P[X\le x]\).  <a href="classumontreal_1_1ssj_1_1gof_1_1FBar.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classumontreal_1_1ssj_1_1gof_1_1FDist.html">FDist</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">This class provides methods to compute (or approximate) the distribution functions of special types of goodness-of-fit test statistics.  <a href="classumontreal_1_1ssj_1_1gof_1_1FDist.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classumontreal_1_1ssj_1_1gof_1_1GofFormat.html">GofFormat</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">This class contains methods used to format results of GOF test statistics, or to apply a series of tests simultaneously and format the results.  <a href="classumontreal_1_1ssj_1_1gof_1_1GofFormat.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classumontreal_1_1ssj_1_1gof_1_1GofStat.html">GofStat</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">This class provides methods to compute several types of EDF goodness-of-fit test statistics and to apply certain transformations to a set of observations.  <a href="classumontreal_1_1ssj_1_1gof_1_1GofStat.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classumontreal_1_1ssj_1_1gof_1_1KernelDensity.html">KernelDensity</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">This static class provides methods to compute a kernel density estimator from a set of \(n\) individual observations \(x_0, …, x_{n-1}\), which define an empirical distribution.  <a href="classumontreal_1_1ssj_1_1gof_1_1KernelDensity.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Goodness-of-fit test Statistics. </p>
<p>This package contains tools for performing univariate <em>goodness-of-fit</em> (GOF) statistical tests. Methods for computing (or approximating) the distribution function \(F(x)\) of certain GOF test statistics, as well as their complementary distribution function \(\bar{F}(x) = 1 - F(x)\), are implemented in classes of package <a class="el" href="namespaceumontreal_1_1ssj_1_1probdist.html">umontreal::ssj::probdist</a>. Tools for computing the GOF test statistics and the corresponding \(p\)-values, and for formating the results, are provided in classes <a class="el" href="classumontreal_1_1ssj_1_1gof_1_1GofStat.html">umontreal.ssj.gof.GofStat</a> and <a class="el" href="classumontreal_1_1ssj_1_1gof_1_1GofFormat.html">umontreal.ssj.gof.GofFormat</a>.</p>
<p>We are concerned here with GOF test statistics for testing the hypothesis \(\mathcal{H}_0\) that a sample of \(N\) observations \(X_1,…,X_N\) comes from a given univariate probability distribution \(F\). We consider tests such as those of Kolmogorov-Smirnov, Anderson-Darling, Crámer-von Mises, etc. These test statistics generally measure, in different ways, the distance between a <em>continuous</em> distribution function \(F\) and the <em>empirical distribution function</em> (EDF) \(\hat{F}_N\) of \(X_1,…,X_N\). They are also called EDF test statistics. The observations \(X_i\) are usually transformed into \(U_i = F (X_i)\), which satisfy \(0\le U_i\le1\) and which follow the \(U(0,1)\) distribution under \(\mathcal{H}_0\). (This is called the <em>probability integral transformation</em>.) Methods for applying this transformation, as well as other types of transformations, to the observations \(X_i\) or \(U_i\) are provided in <a class="el" href="classumontreal_1_1ssj_1_1gof_1_1GofStat.html">umontreal.ssj.gof.GofStat</a>.</p>
<p>Then the GOF tests are applied to the \(U_i\) sorted by increasing order. The corresponding \(p\)-values are easily computed by calling the appropriate methods in the classes of package <a class="el" href="namespaceumontreal_1_1ssj_1_1probdist.html">umontreal::ssj::probdist</a>. If a GOF test statistic \(Y\) has a continuous distribution under \(\mathcal{H}_0\) and takes the value \(y\), its (right) \(p\)-value is defined as \(p = P[Y \ge y \mid\mathcal{H}_0]\). The test usually rejects \(\mathcal{H}_0\) if \(p\) is deemed too close to 0 (for a one-sided test) or too close to 0 or 1 (for a two-sided test).</p>
<p>In the case where \(Y\) has a <em>discrete distribution</em> under \(\mathcal{H}_0\), we distinguish the <em>right \(p\)-value</em> \(p_R = P[Y \ge y \mid\mathcal{H}_0]\) and the <em>left \(p\)-value</em> \(p_L = P[Y \le y \mid\mathcal{H}_0]\). We then define the \(p\)-value for a two-sided test as <a class="anchor" id="REF_gof_overview_eq_pdisc"></a> </p><p class="formulaDsp">
\begin{align} p &amp; = \left\{ \begin{array}{l@{qquad}l} p_R, &amp; \mbox{if } p_R &lt; p_L \\ 1 - p_L, \mbox{if } p_R \ge p_L \mbox{ and } p_L &lt; 0.5 \\ 0.5 &amp; \mbox{otherwise.} \end{array} \right. \tag{pdisc} \end{align}
</p>
<p> Why such a definition? Consider for example a Poisson random variable \(Y\) with mean 1 under \(\mathcal{H}_0\). If \(Y\) takes the value 0, the right \(p\)-value is \(p_R = P[Y \ge0 \mid\mathcal{H}_0] = 1\). In the uniform case, this would obviously lead to rejecting \(\mathcal{H}_0\) on the basis that the \(p\)-value is too close to 1. However, \(P[Y = 0 \mid\mathcal{H}_0] = 1/e \approx0.368\), so it does not really make sense to reject \(\mathcal{H}_0\) in this case. In fact, the left \(p\)-value here is \(p_L = 0.368\), and the \(p\)-value computed with the above definition is \(p = 1 - p_L \approx0.632\). Note that if \(p_L\) is very small, in this definition, \(p\) becomes close to 1. If the left \(p\)-value was defined as \(p_L = 1 - p_R = P[Y &lt; y \mid\mathcal{H}_0]\), this would also lead to problems. In the example, one would have \(p_L = 0\) in that case.</p>
<p>A very common type of test in the discrete case is the <em>chi-square</em> test, which applies when the possible outcomes are partitioned into a finite number of categories. Suppose there are \(k\) categories and that each observation belongs to category \(i\) with probability \(p_i\), for \(0\le i &lt; k\). If there are \(n\) independent observations, the expected number of observations in category \(i\) is \(e_i = n p_i\), and the chi-square test statistic is defined as <a class="anchor" id="REF_gof_overview_eq_chi_square0"></a> </p><p class="formulaDsp">
\[ X^2 = \sum_{i=0}^{k-1} \frac{(o_i - e_i)^2}{e_i} \tag{chi-square0} \]
</p>
<p> where \(o_i\) is the actual number of observations in category \(i\). Assuming that all \(e_i\)’s are large enough (a popular rule of thumb asks for \(e_i \ge5\) for each \(i\)), \(X^2\) follows approximately the chi-square distribution with \(k-1\) degrees of freedom <b>[tREA88a]</b>&thinsp;. The class <a class="el" href="classumontreal_1_1ssj_1_1gof_1_1GofStat_1_1OutcomeCategoriesChi2.html">umontreal.ssj.gof.GofStat.OutcomeCategoriesChi2</a>, a nested class defined inside the <a class="el" href="classumontreal_1_1ssj_1_1gof_1_1GofStat.html">umontreal.ssj.gof.GofStat</a> class, provides tools to automatically regroup categories in the cases where some \(e_i\)’s are too small.</p>
<p>The class <a class="el" href="classumontreal_1_1ssj_1_1gof_1_1GofFormat.html">umontreal.ssj.gof.GofFormat</a> contains methods used to format results of GOF test statistics, or to apply several such tests simultaneously to a given data set and format the results to produce a report that also contains the \(p\)-values of all these tests. A C version of this class is actually used extensively in the package TestU01, which applies statistical tests to random number generators <b>[iLEC01t]</b>&thinsp;. The class also provides tools to plot an empirical or theoretical distribution function, by creating a data file that contains a graphic plot in a format compatible with a given software.</p>
<p><a class="anchor" id="REF_gof_overview_sec_overview"></a> This package contains tools for performing univariate <em>goodness-of-fit</em> (GOF) statistical tests. Methods for computing (or approximating) the distribution function \(F(x)\) of certain GOF test statistics, as well as their complementary distribution function \(\bar{F}(x) = 1 - F(x)\), are implemented in classes of package <a class="el" href="namespaceumontreal_1_1ssj_1_1probdist.html">umontreal::ssj::probdist</a>. Tools for computing the GOF test statistics and the corresponding \(p\)-values, and for formating the results, are provided in classes <a class="el" href="classumontreal_1_1ssj_1_1gof_1_1GofStat.html">umontreal.ssj.gof.GofStat</a> and <a class="el" href="classumontreal_1_1ssj_1_1gof_1_1GofFormat.html">umontreal.ssj.gof.GofFormat</a>.</p>
<p>We are concerned here with GOF test statistics for testing the hypothesis \(\mathcal{H}_0\) that a sample of \(N\) observations \(X_1,…,X_N\) comes from a given univariate probability distribution \(F\). We consider tests such as those of Kolmogorov-Smirnov, Anderson-Darling, Crámer-von Mises, etc. These test statistics generally measure, in different ways, the distance between a <em>continuous</em> distribution function \(F\) and the <em>empirical distribution function</em> (EDF) \(\hat{F}_N\) of \(X_1,…,X_N\). They are also called EDF test statistics. The observations \(X_i\) are usually transformed into \(U_i = F (X_i)\), which satisfy \(0\le U_i\le1\) and which follow the \(U(0,1)\) distribution under \(\mathcal{H}_0\). (This is called the <em>probability integral transformation</em>.) Methods for applying this transformation, as well as other types of transformations, to the observations \(X_i\) or \(U_i\) are provided in <a class="el" href="classumontreal_1_1ssj_1_1gof_1_1GofStat.html">umontreal.ssj.gof.GofStat</a>.</p>
<p>Then the GOF tests are applied to the \(U_i\) sorted by increasing order. The corresponding \(p\)-values are easily computed by calling the appropriate methods in the classes of package <a class="el" href="namespaceumontreal_1_1ssj_1_1probdist.html">umontreal::ssj::probdist</a>. If a GOF test statistic \(Y\) has a continuous distribution under \(\mathcal{H}_0\) and takes the value \(y\), its (right) \(p\)-value is defined as \(p = P[Y \ge y \mid\mathcal{H}_0]\). The test usually rejects \(\mathcal{H}_0\) if \(p\) is deemed too close to 0 (for a one-sided test) or too close to 0 or 1 (for a two-sided test).</p>
<p>In the case where \(Y\) has a <em>discrete distribution</em> under \(\mathcal{H}_0\), we distinguish the <em>right \(p\)-value</em> \(p_R = P[Y \ge y \mid\mathcal{H}_0]\) and the <em>left \(p\)-value</em> \(p_L = P[Y \le y \mid\mathcal{H}_0]\). We then define the \(p\)-value for a two-sided test as <a class="anchor" id="REF_gof_overview_eq_pdisc"></a> </p><p class="formulaDsp">
\begin{align} p &amp; = \left\{ \begin{array}{l@{qquad}l} p_R, &amp; \mbox{if } p_R &lt; p_L \\ 1 - p_L, \mbox{if } p_R \ge p_L \mbox{ and } p_L &lt; 0.5 \\ 0.5 &amp; \mbox{otherwise.} \end{array} \right. \tag{pdisc} \end{align}
</p>
<p> Why such a definition? Consider for example a Poisson random variable \(Y\) with mean 1 under \(\mathcal{H}_0\). If \(Y\) takes the value 0, the right \(p\)-value is \(p_R = P[Y \ge0 \mid\mathcal{H}_0] = 1\). In the uniform case, this would obviously lead to rejecting \(\mathcal{H}_0\) on the basis that the \(p\)-value is too close to 1. However, \(P[Y = 0 \mid\mathcal{H}_0] = 1/e \approx0.368\), so it does not really make sense to reject \(\mathcal{H}_0\) in this case. In fact, the left \(p\)-value here is \(p_L = 0.368\), and the \(p\)-value computed with the above definition is \(p = 1 - p_L \approx0.632\). Note that if \(p_L\) is very small, in this definition, \(p\) becomes close to 1. If the left \(p\)-value was defined as \(p_L = 1 - p_R = P[Y &lt; y \mid\mathcal{H}_0]\), this would also lead to problems. In the example, one would have \(p_L = 0\) in that case.</p>
<p>A very common type of test in the discrete case is the <em>chi-square</em> test, which applies when the possible outcomes are partitioned into a finite number of categories. Suppose there are \(k\) categories and that each observation belongs to category \(i\) with probability \(p_i\), for \(0\le i &lt; k\). If there are \(n\) independent observations, the expected number of observations in category \(i\) is \(e_i = n p_i\), and the chi-square test statistic is defined as <a class="anchor" id="REF_gof_overview_eq_chi_square0"></a> </p><p class="formulaDsp">
\[ X^2 = \sum_{i=0}^{k-1} \frac{(o_i - e_i)^2}{e_i} \tag{chi-square0} \]
</p>
<p> where \(o_i\) is the actual number of observations in category \(i\). Assuming that all \(e_i\)’s are large enough (a popular rule of thumb asks for \(e_i \ge5\) for each \(i\)), \(X^2\) follows approximately the chi-square distribution with \(k-1\) degrees of freedom <b>[tREA88a]</b>&thinsp;. The class <a class="el" href="classumontreal_1_1ssj_1_1gof_1_1GofStat_1_1OutcomeCategoriesChi2.html">umontreal.ssj.gof.GofStat.OutcomeCategoriesChi2</a>, a nested class defined inside the <a class="el" href="classumontreal_1_1ssj_1_1gof_1_1GofStat.html">umontreal.ssj.gof.GofStat</a> class, provides tools to automatically regroup categories in the cases where some \(e_i\)’s are too small.</p>
<p>The class <a class="el" href="classumontreal_1_1ssj_1_1gof_1_1GofFormat.html">umontreal.ssj.gof.GofFormat</a> contains methods used to format results of GOF test statistics, or to apply several such tests simultaneously to a given data set and format the results to produce a report that also contains the \(p\)-values of all these tests. A C version of this class is actually used extensively in the package TestU01, which applies statistical tests to random number generators <b>[iLEC01t]</b>&thinsp;. The class also provides tools to plot an empirical or theoretical distribution function, by creating a data file that contains a graphic plot in a format compatible with a given software. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.14
</small></address>
</body>
</html>
