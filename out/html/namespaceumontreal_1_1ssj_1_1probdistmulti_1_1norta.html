<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SSJ: Package umontreal.ssj.probdistmulti.norta</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="ssj.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">SSJ
   </div>
   <div id="projectbrief">Stochastic Simulation in Java</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><b>umontreal</b></li><li class="navelem"><b>ssj</b></li><li class="navelem"><a class="el" href="namespaceumontreal_1_1ssj_1_1probdistmulti.html">probdistmulti</a></li><li class="navelem"><a class="el" href="namespaceumontreal_1_1ssj_1_1probdistmulti_1_1norta.html">norta</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a>  </div>
  <div class="headertitle">
<div class="title">Package umontreal.ssj.probdistmulti.norta</div>  </div>
</div><!--header-->
<div class="contents">

<p>This package implements the correlation matching algorithms proposed in <a class="el" href="citelist.html#CITEREF_sAVR06a">[13]</a>&thinsp; for the situation where one wants to use the NORTA method to fit a multivariate distribution with discrete marginals.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classumontreal_1_1ssj_1_1probdistmulti_1_1norta_1_1NI1.html">NI1</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Extends the class <a class="el" href="classumontreal_1_1ssj_1_1probdistmulti_1_1norta_1_1NortaInitDisc.html">NortaInitDisc</a> and implements the algorithm <a class="el" href="classumontreal_1_1ssj_1_1probdistmulti_1_1norta_1_1NI1.html" title="Extends the class NortaInitDisc and implements the algorithm NI1.">NI1</a>.  <a href="classumontreal_1_1ssj_1_1probdistmulti_1_1norta_1_1NI1.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classumontreal_1_1ssj_1_1probdistmulti_1_1norta_1_1NI2a.html">NI2a</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Extends the class <a class="el" href="classumontreal_1_1ssj_1_1probdistmulti_1_1norta_1_1NortaInitDisc.html">NortaInitDisc</a> and implements the algorithm <a class="el" href="classumontreal_1_1ssj_1_1probdistmulti_1_1norta_1_1NI2a.html" title="Extends the class NortaInitDisc and implements the algorithm NI2a.">NI2a</a>.  <a href="classumontreal_1_1ssj_1_1probdistmulti_1_1norta_1_1NI2a.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classumontreal_1_1ssj_1_1probdistmulti_1_1norta_1_1NI2b.html">NI2b</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Extends the class <a class="el" href="classumontreal_1_1ssj_1_1probdistmulti_1_1norta_1_1NortaInitDisc.html">NortaInitDisc</a> and implements the algorithm <a class="el" href="classumontreal_1_1ssj_1_1probdistmulti_1_1norta_1_1NI2b.html" title="Extends the class NortaInitDisc and implements the algorithm NI2b.">NI2b</a>.  <a href="classumontreal_1_1ssj_1_1probdistmulti_1_1norta_1_1NI2b.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classumontreal_1_1ssj_1_1probdistmulti_1_1norta_1_1NI3.html">NI3</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Extends the class <a class="el" href="classumontreal_1_1ssj_1_1probdistmulti_1_1norta_1_1NortaInitDisc.html">NortaInitDisc</a> and implements the algorithm <a class="el" href="classumontreal_1_1ssj_1_1probdistmulti_1_1norta_1_1NI3.html" title="Extends the class NortaInitDisc and implements the algorithm NI3.">NI3</a>.  <a href="classumontreal_1_1ssj_1_1probdistmulti_1_1norta_1_1NI3.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classumontreal_1_1ssj_1_1probdistmulti_1_1norta_1_1NortaInitDisc.html">NortaInitDisc</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">This abstract class defines the algorithms used for NORTA initialization when the marginal distributions are discrete.  <a href="classumontreal_1_1ssj_1_1probdistmulti_1_1norta_1_1NortaInitDisc.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This package implements the correlation matching algorithms proposed in <a class="el" href="citelist.html#CITEREF_sAVR06a">[13]</a>&thinsp; for the situation where one wants to use the NORTA method to fit a multivariate distribution with discrete marginals. </p>
<p>The four different algorithms discussed in <a class="el" href="citelist.html#CITEREF_sAVR06a">[13]</a>&thinsp; are implemented in four subclasses of an abstract class named <code><a class="el" href="classumontreal_1_1ssj_1_1probdistmulti_1_1norta_1_1NortaInitDisc.html" title="This abstract class defines the algorithms used for NORTA initialization when the marginal distributi...">NortaInitDisc</a></code>. This software makes use of the SSJ library <a class="el" href="citelist.html#CITEREF_iLEC04j">[152]</a>&thinsp;. An example of how to use it is given at the end of this document.</p>
<p>The NORTA method is an approach for modeling dependence in a finite-dimensional random vector \(X=(X_1,…,X_d)\) with given univariate marginals via normal copula that fits the rank or the linear correlation between each pair of coordinates of \(X\). The standard normal distribution function is applied to each coordinate of a vector \(Z=(Z_1,…,Z_d)\) of correlated standard normals to produce a vector \(U=(U_1,…,U_d)\) of correlated uniforms over \([0,1]\). Then \(X\) is obtained by applying the inverse of each marginal distribution function to each coordinate of \(U\). The fitting requires finding the correlation between the coordinates of each pair of \(Z\) that would yield the correlation between the coordinates of the corresponding pair of \(X\). The step of finding the correlation matrix of \(Z\), given the correlation matrix of \(X\) and the marginal distributions, constitutes the NORTA initialization step. In <a class="el" href="citelist.html#CITEREF_sAVR06a">[13]</a>&thinsp;, we present a detailed analysis of the NORTA method and root-finding problem when the marginal distributions are discrete.</p>
<p>With the NORTA method, we have the following representation: </p><p class="formulaDsp">
\[ X_l=F_l^{-1}(\Phi(Z_l)), \quad l=1,…,d, \]
</p>
<p> where \(\Phi\) is the standard normal distribution function and \(F_l^{-1}(u) = \inf\{x: F_l(x) \ge u\}\) for \(0\le u \le1\), which is the quantile function of the marginal distribution \(F_l, l=1,…,d\).</p>
<p>For the bivariate case ( \(d=2\)), we have a vector \(X=(X_1, X_2)\) and the two marginal distributions \(F_1\) and \(F_2\) with means and standard deviations \(\mu_{F_1}=E[F_1(X_1)]\), \(\mu_{F_2}=E[F_2(X_2)]\), \(\sigma_{F_1}=\mbox{Var}(F_1(X_1))^{1/2}\) and \(\sigma_{F_2}=\mbox{Var}(F_2(X_2))^{1/2}\), respectively. For this case, NORTA initialization is reduced to the problem of finding the correlation \(\rho_Z=\mbox{Corr}(Z_1,Z_2)\).</p>
<p>In this document, we present a set of Java classes for NORTA initialization in the bivariate case given the rank correlation and two discrete marginal distributions. We have: <a class="anchor" id="REF_probdistmulti_norta_overview_r"></a> </p><p class="formulaDsp">
\begin{align} \tag{r} r_X(\rho)=\mbox{Corr}(F_1(X_1),F_2(X_2))=\frac{g_r(\rho) -\mu_{F_1}\mu_{F_2} }{\sigma_{F_1}\sigma_{F_2}}, \end{align}
</p>
<p> where: <a class="anchor" id="REF_probdistmulti_norta_overview_gr"></a> </p><p class="formulaDsp">
\begin{align} g_r(\rho) &amp; = E \left[ F_1 (X_1) F_2 (X_2) \right]\nonumber \\ &amp; = \int_{-\infty}^{\infty} \int_{-\infty}^{\infty} F_1 \{ F_1^{-1} [ \Phi(x_1)]\} F_2\{ F_2^{-1}[\Phi(x_2)]\} \phi_{\rho}(x_1,x_2) dx_1 dx_2, \tag{gr} \end{align}
</p>
<p> where \(\phi_{\rho}\) is the bivariate standard normal density. Then, for a given correlation \(r_X\), we use an algorithm of root-finder to find the corresponding correlation \(\rho_Z\) that verifies <a class="anchor" id="REF_probdistmulti_norta_overview_fr"></a> </p><p class="formulaDsp">
\begin{align} \tag{fr} f_r(\rho_Z)=g_r(\rho_Z)-r_X\sigma_{F_1}\sigma_{F_2}-\mu_{F_1}\mu_{F_2}=0. \end{align}
</p>
<p> When the marginal distributions are continuous, the root-finding problem is easy to solve when we use the rank correlation. We have an analytic solution for ( <a class="el" href="namespaceumontreal_1_1ssj_1_1probdistmulti_1_1norta.html#REF_probdistmulti_norta_overview_gr">gr</a> ) and the relation in ( <a class="el" href="namespaceumontreal_1_1ssj_1_1probdistmulti_1_1norta.html#REF_probdistmulti_norta_overview_r">r</a> ) becomes: </p><p class="formulaDsp">
\begin{align} r_X(\rho)=(6/\pi) \arcsin(\rho/2).\nonumber \end{align}
</p>
<h1>Example</h1>
<p>In this example, we consider two random variables \(X_1\) and \(X_2\) with negative binomial marginals, denoted by NegBin \((s,p)\). In our example, the parameters \((s,p)\) for \(X_1\) and \(X_2\), respectively, are: \(s_1=15.68\), \(p_1=0.3861\), \(s_2=60.21\) and \(p_2=0.6211\). We want to calculate the correlation \(\rho_Z\) for a target rank correlation \(r_X=0.43\). Since the negative binomial has an unbounded support, we set the upper bound points of each support at the quantile of order \(tr=1-10^{-6}\), so that the number of support points \(m_l=F_l^{-1}(1-10^{-6})+1\), for \(l=1,2\).</p>
<p>The Java program uses the class <a class="el" href="classumontreal_1_1ssj_1_1probdist_1_1DiscreteDistributionInt.html">umontreal.ssj.probdist.DiscreteDistributionInt</a> of package <code>probdist</code> from SSJ, to specify the two discrete marginal distributions. Each of the four subclasses <a class="el" href="classumontreal_1_1ssj_1_1probdistmulti_1_1norta_1_1NI1.html">NI1</a>, <a class="el" href="classumontreal_1_1ssj_1_1probdistmulti_1_1norta_1_1NI2a.html">NI2a</a>, <a class="el" href="classumontreal_1_1ssj_1_1probdistmulti_1_1norta_1_1NI2b.html">NI2b</a> and <a class="el" href="classumontreal_1_1ssj_1_1probdistmulti_1_1norta_1_1NI3.html">NI3</a> are called for each algorithm to compute the correlation \(\rho_Z\), so we can compare the results.</p>
<p><b>Example with correlated negative binomial distributions.</b> &emsp;[Collision] <a class="anchor" id="REF_probdistmulti_norta_overview_lst_Collision"></a></p><div class="fragment"><div class="line"><span class="keyword">package </span>probdistmulti.norta;</div><div class="line"></div><div class="line"><span class="keyword">import</span> umontreal.ssj.probdist.*;</div><div class="line"><span class="keyword">import</span> umontreal.ssj.probdistmulti.norta.*;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>ExampleNortaInitDisc</div><div class="line">{</div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keywordtype">void</span> main (String[] args) {</div><div class="line">    <span class="keyword">final</span> <span class="keywordtype">double</span> rX = 0.43;              <span class="comment">// Target rank correlation rX</span></div><div class="line">    <span class="keyword">final</span> <span class="keywordtype">double</span> tr = 1.0 - 1.0e-6;      <span class="comment">// Quantile upper limit</span></div><div class="line"></div><div class="line">    <span class="comment">// Define the two marginal distributions</span></div><div class="line">    DiscreteDistributionInt dist1 = <span class="keyword">new</span> NegativeBinomialDist(15.68, 0.3861);</div><div class="line">    DiscreteDistributionInt dist2 = <span class="keyword">new</span> NegativeBinomialDist(60.21, 0.6211);</div><div class="line"></div><div class="line">    NI1 ni1Obj = <span class="keyword">new</span> NI1(rX, dist1, dist2, tr, 1.0e-4);</div><div class="line">    System.out.println(<span class="stringliteral">&quot;Result with method NI1:  rho_Z = &quot;</span></div><div class="line">               + String.format(<span class="stringliteral">&quot;%.14g&quot;</span>, ni1Obj.computeCorr()));</div><div class="line">    NI2a ni2aObj = <span class="keyword">new</span> NI2a(rX, dist1, dist2, tr, 0.005, 1.0e-4);</div><div class="line">    System.out.println(<span class="stringliteral">&quot;Result with method NI2b: rho_Z = &quot;</span></div><div class="line">               + String.format(<span class="stringliteral">&quot;%.14g&quot;</span>, ni2aObj.computeCorr()));</div><div class="line">    NI2b ni2bObj = <span class="keyword">new</span> NI2b(rX, dist1, dist2, tr, 5, 1.0e-4);</div><div class="line">    System.out.println(<span class="stringliteral">&quot;Result with method NI2a: rho_Z = &quot;</span></div><div class="line">               + String.format(<span class="stringliteral">&quot;%.14g&quot;</span>, ni2bObj.computeCorr()));</div><div class="line">    NI3 ni3Obj = <span class="keyword">new</span> NI3(rX, dist1, dist2, tr, 1.0e-4);</div><div class="line">    System.out.println(<span class="stringliteral">&quot;Result with method NI3:  rho_Z = &quot;</span></div><div class="line">               + String.format(<span class="stringliteral">&quot;%.14g&quot;</span>, ni3Obj.computeCorr()));</div><div class="line">    }</div><div class="line">}</div></div><!-- fragment --><p> <b>Results of the program <code>ExampleNortaInitDisc.java</code></b> &emsp;[Collision] <a class="anchor" id="REF_probdistmulti_norta_overview_res_Collision"></a></p><div class="fragment"><div class="line">Result with method NI1:  rho_Z = 0.44691425135002</div><div class="line">Result with method NI2b: rho_Z = 0.44685851640499</div><div class="line">Result with method NI2a: rho_Z = 0.44683779468645</div><div class="line">Result with method NI3:  rho_Z = 0.44691432915086</div></div><!-- fragment --> </div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.15
</small></address>
</body>
</html>
