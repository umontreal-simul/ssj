<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>HilbertCurveMap Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="ssj.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
    <td style="padding-left: 0.5em;">
    <div id="projectbrief">Stochastic Simulation in Java</div>
    </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><b>umontreal</b></li><li class="navelem"><b>ssj</b></li><li class="navelem"><a class="el" href="namespaceumontreal_1_1ssj_1_1util.html">util</a></li><li class="navelem"><a class="el" href="namespaceumontreal_1_1ssj_1_1util_1_1sort.html">sort</a></li><li class="navelem"><a class="el" href="classumontreal_1_1ssj_1_1util_1_1sort_1_1HilbertCurveMap.html">HilbertCurveMap</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pac-methods">Package Functions</a> &#124;
<a href="#pac-attribs">Package Attributes</a> &#124;
<a href="classumontreal_1_1ssj_1_1util_1_1sort_1_1HilbertCurveMap-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">HilbertCurveMap Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This class implements the mapping of a Hilbert curve in the \(d\)-dimensional unit hypercube \([0,1)^d\).  
 <a href="classumontreal_1_1ssj_1_1util_1_1sort_1_1HilbertCurveMap.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a64a912d2d1762e7a4d708d2eb26ae8c1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classumontreal_1_1ssj_1_1util_1_1sort_1_1HilbertCurveMap.html#a64a912d2d1762e7a4d708d2eb26ae8c1">HilbertCurveMap</a> (int d, int m)</td></tr>
<tr class="memdesc:a64a912d2d1762e7a4d708d2eb26ae8c1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructs a <a class="el" href="classumontreal_1_1ssj_1_1util_1_1sort_1_1HilbertCurveMap.html">HilbertCurveMap</a> object that will use the first \(m\) bits of each of the first <code>d</code> coordinates to sort the points.  <a href="#a64a912d2d1762e7a4d708d2eb26ae8c1">More...</a><br /></td></tr>
<tr class="separator:a64a912d2d1762e7a4d708d2eb26ae8c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1390b472bf017867bc4860999f5d963"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classumontreal_1_1ssj_1_1util_1_1sort_1_1HilbertCurveMap.html#ae1390b472bf017867bc4860999f5d963">HilbertCurveMap</a> (int d)</td></tr>
<tr class="memdesc:ae1390b472bf017867bc4860999f5d963"><td class="mdescLeft">&#160;</td><td class="mdescRight">This constructor is similar to <a class="el" href="classumontreal_1_1ssj_1_1util_1_1sort_1_1HilbertCurveMap.html#a64a912d2d1762e7a4d708d2eb26ae8c1" title="Constructs a HilbertCurveMap object that will use the first  bits of each of the first d coordinates ...">HilbertCurveMap(int,int)</a>, but the parameter \(m = \lfloor63/d\rfloor\).  <a href="#ae1390b472bf017867bc4860999f5d963">More...</a><br /></td></tr>
<tr class="separator:ae1390b472bf017867bc4860999f5d963"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe81a2fadde630519c7abc1d05c463cf"><td class="memItemLeft" align="right" valign="top"><a id="abe81a2fadde630519c7abc1d05c463cf"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classumontreal_1_1ssj_1_1util_1_1sort_1_1HilbertCurveMap.html#abe81a2fadde630519c7abc1d05c463cf">dimension</a> ()</td></tr>
<tr class="memdesc:abe81a2fadde630519c7abc1d05c463cf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the dimension of the unit hypercube. <br /></td></tr>
<tr class="separator:abe81a2fadde630519c7abc1d05c463cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93c03821274b468bc62d1b92760b46c7"><td class="memItemLeft" align="right" valign="top"><a id="a93c03821274b468bc62d1b92760b46c7"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classumontreal_1_1ssj_1_1util_1_1sort_1_1HilbertCurveMap.html#a93c03821274b468bc62d1b92760b46c7">getM</a> ()</td></tr>
<tr class="memdesc:a93c03821274b468bc62d1b92760b46c7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the number of bits \(m\) that is used to divide the axis of each coordinate. <br /></td></tr>
<tr class="separator:a93c03821274b468bc62d1b92760b46c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a513b74c7ff8e638e54f7488e20da845c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classumontreal_1_1ssj_1_1util_1_1sort_1_1HilbertCurveMap.html#a513b74c7ff8e638e54f7488e20da845c">indexToCoordinates</a> (long r, int[] a)</td></tr>
<tr class="memdesc:a513b74c7ff8e638e54f7488e20da845c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Takes as input the Hilbert index \(r\) of a subcube and returns in <code>a[]</code> its integer coordinates.  <a href="#a513b74c7ff8e638e54f7488e20da845c">More...</a><br /></td></tr>
<tr class="separator:a513b74c7ff8e638e54f7488e20da845c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a713b42dd75c8093bc477773087a9d020"><td class="memItemLeft" align="right" valign="top"><a id="a713b42dd75c8093bc477773087a9d020"></a>
long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classumontreal_1_1ssj_1_1util_1_1sort_1_1HilbertCurveMap.html#a713b42dd75c8093bc477773087a9d020">coordinatesToIndex</a> (int a[])</td></tr>
<tr class="memdesc:a713b42dd75c8093bc477773087a9d020"><td class="mdescLeft">&#160;</td><td class="mdescRight">Takes as input in <code>a[]</code> the integer coordinates of a subcube and returns the corresponding Hilbert index \(r\). <br /></td></tr>
<tr class="separator:a713b42dd75c8093bc477773087a9d020"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a94bd22d7fc94c0c71402b803eb66e8ee"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classumontreal_1_1ssj_1_1util_1_1sort_1_1HilbertCurveMap.html#a94bd22d7fc94c0c71402b803eb66e8ee">pointToCoordinates</a> (double[] p, int[] a)</td></tr>
<tr class="memdesc:a94bd22d7fc94c0c71402b803eb66e8ee"><td class="mdescLeft">&#160;</td><td class="mdescRight">Takes in <code>p[]</code> a point with real-valued coordinates and places in <code>a[]</code> the integer coordinates of the corresponding subcube.  <a href="#a94bd22d7fc94c0c71402b803eb66e8ee">More...</a><br /></td></tr>
<tr class="separator:a94bd22d7fc94c0c71402b803eb66e8ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pac-methods"></a>
Package Functions</h2></td></tr>
<tr class="memitem:a6a3745a608949257cc9c8dcd35bb6e72"><td class="memItemLeft" align="right" valign="top"><a id="a6a3745a608949257cc9c8dcd35bb6e72"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>initTables</b> ()</td></tr>
<tr class="separator:a6a3745a608949257cc9c8dcd35bb6e72"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pac-attribs"></a>
Package Attributes</h2></td></tr>
<tr class="memitem:a1a8a8235879363159315091a1daed72f"><td class="memItemLeft" align="right" valign="top"><a id="a1a8a8235879363159315091a1daed72f"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>dimension</b></td></tr>
<tr class="separator:a1a8a8235879363159315091a1daed72f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a742204794ea328ba293fe59cec79b990"><td class="memItemLeft" align="right" valign="top"><a id="a742204794ea328ba293fe59cec79b990"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>m</b></td></tr>
<tr class="separator:a742204794ea328ba293fe59cec79b990"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5066e19d8c6b7bb71c06ffb39d1333d1"><td class="memItemLeft" align="right" valign="top"><a id="a5066e19d8c6b7bb71c06ffb39d1333d1"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>maxnbits</b></td></tr>
<tr class="separator:a5066e19d8c6b7bb71c06ffb39d1333d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a601639a266b6cd1b91eddacff854c9ac"><td class="memItemLeft" align="right" valign="top"><a id="a601639a266b6cd1b91eddacff854c9ac"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>maxlength</b></td></tr>
<tr class="separator:a601639a266b6cd1b91eddacff854c9ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afdba7d95d0da64e4bf00df6c75070fa0"><td class="memItemLeft" align="right" valign="top"><a id="afdba7d95d0da64e4bf00df6c75070fa0"></a>
int []&#160;</td><td class="memItemRight" valign="bottom"><b>p_to_s</b></td></tr>
<tr class="separator:afdba7d95d0da64e4bf00df6c75070fa0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a133cde0a387b151af9a30d18942f7115"><td class="memItemLeft" align="right" valign="top"><a id="a133cde0a387b151af9a30d18942f7115"></a>
int []&#160;</td><td class="memItemRight" valign="bottom"><b>s_to_p</b></td></tr>
<tr class="separator:a133cde0a387b151af9a30d18942f7115"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa52db4b512457ae2659ec8a04099c130"><td class="memItemLeft" align="right" valign="top"><a id="aa52db4b512457ae2659ec8a04099c130"></a>
int []&#160;</td><td class="memItemRight" valign="bottom"><b>p_to_J</b></td></tr>
<tr class="separator:aa52db4b512457ae2659ec8a04099c130"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad93c47bf972388892c499a6beed9c004"><td class="memItemLeft" align="right" valign="top"><a id="ad93c47bf972388892c499a6beed9c004"></a>
int []&#160;</td><td class="memItemRight" valign="bottom"><b>bit</b></td></tr>
<tr class="separator:ad93c47bf972388892c499a6beed9c004"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4907013f9f6c883faa95b344747df103"><td class="memItemLeft" align="right" valign="top"><a id="a4907013f9f6c883faa95b344747df103"></a>
int []&#160;</td><td class="memItemRight" valign="bottom"><b>parity</b></td></tr>
<tr class="separator:a4907013f9f6c883faa95b344747df103"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a39bc136671da405aa0c85df2e85ab850"><td class="memItemLeft" align="right" valign="top"><a id="a39bc136671da405aa0c85df2e85ab850"></a>
int [][]&#160;</td><td class="memItemRight" valign="bottom"><b>circshift</b></td></tr>
<tr class="separator:a39bc136671da405aa0c85df2e85ab850"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e855a715bae2fe1ad0951c0fd0cac14"><td class="memItemLeft" align="right" valign="top"><a id="a3e855a715bae2fe1ad0951c0fd0cac14"></a>
int [][]&#160;</td><td class="memItemRight" valign="bottom"><b>bitof</b></td></tr>
<tr class="separator:a3e855a715bae2fe1ad0951c0fd0cac14"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This class implements the mapping of a Hilbert curve in the \(d\)-dimensional unit hypercube \([0,1)^d\). </p>
<p>This mapping can be used for sorting algorithms.</p>
<p>This map (conceptually) divides the unit hypercube \([0,1)^d\) in \(2^{dm}\) subcubes of equal sizes, by dividing each axis in \(2^m\) equal parts, and uses the first \(m\) bits of each of the \(d\) coordinates to place each point in one of the subcubes. It then enumerates the subcubes in the same order as a Hilbert curve in \([0,1)^d\) would visit them, and orders the points accordingly. Each cube has an (integer) Hilbert index \(r\) from 0 to \(2^{dm}-1\) and the cubes (and points) are ordered according to this index. Two points that fall in the same subcube can be placed in an unspecified (arbitrary) order.</p>
<p>For the implementation of sorts based on the Hilbert curve (or Hilbert index), we identify and sort the subcubes by their Hilbert index, but it is also convenient to identify them (alternatively) with \(m\)-bit integer coordinates: The subcube with coordinates \((i_1,…,i_d)\) is defined as \(\prod_{j=0}^{d-1} [i_j 2^{-m},  (i_j+1) 2^{-m})\). Note that each interval is open on the right. That is, if we multiply the coordinates of a point in the subcube by \(2^m\) and truncate them to integers, we obtain the integer coordinates of the subcube. For example, if \(d=2\) and \(m=4\), we have \(2^8 = 256\) subcubes, whose integer coordinates go from 0 to 15, and the point \((0.1, 0.51)\) belongs to the subcube with integer coordinates \((1, 8)\).</p>
<p>For given \(d\) and \(m\), this class offers methods to compute the integer coordinates of the corresponding subcube from the real-valued coordinates of a point in \([0,1)^d\), as well as the Hilbert index of a subcube from its integer coordinates, and vice versa. The code that computes the latter correspondences is taken (with slight adaptations) from the <code>hilbert.c</code> program of Spencer W. Thomas, University of Michigan, 1991.</p>
<div class="SSJ-bigskip"></div> </div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a64a912d2d1762e7a4d708d2eb26ae8c1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a64a912d2d1762e7a4d708d2eb26ae8c1">&#9670;&nbsp;</a></span>HilbertCurveMap() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classumontreal_1_1ssj_1_1util_1_1sort_1_1HilbertCurveMap.html">HilbertCurveMap</a> </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>m</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructs a <a class="el" href="classumontreal_1_1ssj_1_1util_1_1sort_1_1HilbertCurveMap.html">HilbertCurveMap</a> object that will use the first \(m\) bits of each of the first <code>d</code> coordinates to sort the points. </p>
<p>In this implementation, one must have \(md \le63\). </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">d</td><td>maximum dimension </td></tr>
    <tr><td class="paramname">m</td><td>number of bits used for each coordinate </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ae1390b472bf017867bc4860999f5d963"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae1390b472bf017867bc4860999f5d963">&#9670;&nbsp;</a></span>HilbertCurveMap() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classumontreal_1_1ssj_1_1util_1_1sort_1_1HilbertCurveMap.html">HilbertCurveMap</a> </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>d</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This constructor is similar to <a class="el" href="classumontreal_1_1ssj_1_1util_1_1sort_1_1HilbertCurveMap.html#a64a912d2d1762e7a4d708d2eb26ae8c1" title="Constructs a HilbertCurveMap object that will use the first  bits of each of the first d coordinates ...">HilbertCurveMap(int,int)</a>, but the parameter \(m = \lfloor63/d\rfloor\). </p>
<p>In this implementation, one must have \(md \le63\). </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">d</td><td>maximum dimension </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a513b74c7ff8e638e54f7488e20da845c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a513b74c7ff8e638e54f7488e20da845c">&#9670;&nbsp;</a></span>indexToCoordinates()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void indexToCoordinates </td>
          <td>(</td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int []&#160;</td>
          <td class="paramname"><em>a</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Takes as input the Hilbert index \(r\) of a subcube and returns in <code>a[]</code> its integer coordinates. </p>
<p>WARNING: This method currently works only for \(m \le9\). It is not used for the sort. </p>

</div>
</div>
<a id="a94bd22d7fc94c0c71402b803eb66e8ee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a94bd22d7fc94c0c71402b803eb66e8ee">&#9670;&nbsp;</a></span>pointToCoordinates()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void pointToCoordinates </td>
          <td>(</td>
          <td class="paramtype">double []&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int []&#160;</td>
          <td class="paramname"><em>a</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Takes in <code>p[]</code> a point with real-valued coordinates and places in <code>a[]</code> the integer coordinates of the corresponding subcube. </p>
<p>The two arrays are assumed to have length \(d\). </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>HilbertCurveMap.java</li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.14
</small></address>
</body>
</html>
