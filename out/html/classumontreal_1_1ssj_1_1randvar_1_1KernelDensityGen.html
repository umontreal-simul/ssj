<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>KernelDensityGen Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="ssj.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
    <td style="padding-left: 0.5em;">
    <div id="projectbrief">Stochastic Simulation in Java</div>
    </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><b>umontreal</b></li><li class="navelem"><b>ssj</b></li><li class="navelem"><a class="el" href="namespaceumontreal_1_1ssj_1_1randvar.html">randvar</a></li><li class="navelem"><a class="el" href="classumontreal_1_1ssj_1_1randvar_1_1KernelDensityGen.html">KernelDensityGen</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="classumontreal_1_1ssj_1_1randvar_1_1KernelDensityGen-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">KernelDensityGen Class Reference<div class="ingroups"><a class="el" href="group__randvar__continuous.html">[randvar] Generators for Continuous Distributions</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>This class implements random variate generators for distributions obtained via <em>kernel density estimation</em> methods from a set of \(n\) individual observations \(x_1,â€¦,x_n\) <a class="el" href="citelist.html#CITEREF_tDEV85a">[42]</a>, <a class="el" href="citelist.html#CITEREF_rDEV86a">[43]</a>, <a class="el" href="citelist.html#CITEREF_rHOR00a">[84]</a>, <a class="el" href="citelist.html#CITEREF_rHOR04a">[85]</a>, <a class="el" href="citelist.html#CITEREF_tSIL86a">[190]</a>&thinsp;.  
 <a href="classumontreal_1_1ssj_1_1randvar_1_1KernelDensityGen.html#details">More...</a></p>
<div class="dynheader">
Inheritance diagram for KernelDensityGen:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classumontreal_1_1ssj_1_1randvar_1_1KernelDensityGen__inherit__graph.svg" width="202" height="187"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for KernelDensityGen:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classumontreal_1_1ssj_1_1randvar_1_1KernelDensityGen__coll__graph.svg" width="238" height="216"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:acdfae3836c94088ffd81d8ee95dac574"><td class="memItemLeft" align="right" valign="top"><a id="acdfae3836c94088ffd81d8ee95dac574"></a>
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classumontreal_1_1ssj_1_1randvar_1_1KernelDensityGen.html#acdfae3836c94088ffd81d8ee95dac574">KernelDensityGen</a> (<a class="el" href="interfaceumontreal_1_1ssj_1_1rng_1_1RandomStream.html">RandomStream</a> s, <a class="el" href="classumontreal_1_1ssj_1_1probdist_1_1EmpiricalDist.html">EmpiricalDist</a> dist, <a class="el" href="classumontreal_1_1ssj_1_1randvar_1_1RandomVariateGen.html">RandomVariateGen</a> kGen, double h)</td></tr>
<tr class="memdesc:acdfae3836c94088ffd81d8ee95dac574"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates a new generator for a kernel density estimated from the observations given by the empirical distribution <code>dist</code>, using stream <code>s</code> to select the observations, generator <code>kGen</code> to generate the added noise from the kernel density, and bandwidth <code>h</code>. <br /></td></tr>
<tr class="separator:acdfae3836c94088ffd81d8ee95dac574"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa798ef01a79e43917669d37de148343c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classumontreal_1_1ssj_1_1randvar_1_1KernelDensityGen.html#aa798ef01a79e43917669d37de148343c">KernelDensityGen</a> (<a class="el" href="interfaceumontreal_1_1ssj_1_1rng_1_1RandomStream.html">RandomStream</a> s, <a class="el" href="classumontreal_1_1ssj_1_1probdist_1_1EmpiricalDist.html">EmpiricalDist</a> dist, <a class="el" href="classumontreal_1_1ssj_1_1randvar_1_1NormalGen.html">NormalGen</a> kGen)</td></tr>
<tr class="memdesc:aa798ef01a79e43917669d37de148343c"><td class="mdescLeft">&#160;</td><td class="mdescRight">This constructor uses a gaussian kernel and the default bandwidth \(h = \alpha_k h_0\) with the \(\alpha_k\) suggested in Table&#160; <a class="el" href="classumontreal_1_1ssj_1_1randvar_1_1KernelDensityGen.html#REF_randvar_KernelDensityGen_tab_kernels">kernels</a> for the gaussian distribution.  <a href="#aa798ef01a79e43917669d37de148343c">More...</a><br /></td></tr>
<tr class="separator:aa798ef01a79e43917669d37de148343c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classumontreal_1_1ssj_1_1randvar_1_1RandomVariateGen"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classumontreal_1_1ssj_1_1randvar_1_1RandomVariateGen')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classumontreal_1_1ssj_1_1randvar_1_1RandomVariateGen.html">RandomVariateGen</a></td></tr>
<tr class="memitem:ac4df0f38894268903cf9f7e668510a02 inherit pub_methods_classumontreal_1_1ssj_1_1randvar_1_1RandomVariateGen"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classumontreal_1_1ssj_1_1randvar_1_1RandomVariateGen.html#ac4df0f38894268903cf9f7e668510a02">RandomVariateGen</a> (<a class="el" href="interfaceumontreal_1_1ssj_1_1rng_1_1RandomStream.html">RandomStream</a> s, <a class="el" href="interfaceumontreal_1_1ssj_1_1probdist_1_1Distribution.html">Distribution</a> dist)</td></tr>
<tr class="memdesc:ac4df0f38894268903cf9f7e668510a02 inherit pub_methods_classumontreal_1_1ssj_1_1randvar_1_1RandomVariateGen"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates a new random variate generator from the distribution <code>dist</code>, using stream <code>s</code>.  <a href="classumontreal_1_1ssj_1_1randvar_1_1RandomVariateGen.html#ac4df0f38894268903cf9f7e668510a02">More...</a><br /></td></tr>
<tr class="separator:ac4df0f38894268903cf9f7e668510a02 inherit pub_methods_classumontreal_1_1ssj_1_1randvar_1_1RandomVariateGen"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8143b8bd8ccdea3248e4fc7867c1ab6 inherit pub_methods_classumontreal_1_1ssj_1_1randvar_1_1RandomVariateGen"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classumontreal_1_1ssj_1_1randvar_1_1RandomVariateGen.html#aa8143b8bd8ccdea3248e4fc7867c1ab6">nextDouble</a> ()</td></tr>
<tr class="memdesc:aa8143b8bd8ccdea3248e4fc7867c1ab6 inherit pub_methods_classumontreal_1_1ssj_1_1randvar_1_1RandomVariateGen"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generates a random number from the continuous distribution contained in this object.  <a href="classumontreal_1_1ssj_1_1randvar_1_1RandomVariateGen.html#aa8143b8bd8ccdea3248e4fc7867c1ab6">More...</a><br /></td></tr>
<tr class="separator:aa8143b8bd8ccdea3248e4fc7867c1ab6 inherit pub_methods_classumontreal_1_1ssj_1_1randvar_1_1RandomVariateGen"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9cad3813799df7ee03accea2bb4d086 inherit pub_methods_classumontreal_1_1ssj_1_1randvar_1_1RandomVariateGen"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classumontreal_1_1ssj_1_1randvar_1_1RandomVariateGen.html#ad9cad3813799df7ee03accea2bb4d086">nextArrayOfDouble</a> (double[] v, int start, int n)</td></tr>
<tr class="memdesc:ad9cad3813799df7ee03accea2bb4d086 inherit pub_methods_classumontreal_1_1ssj_1_1randvar_1_1RandomVariateGen"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generates <code>n</code> random numbers from the continuous distribution contained in this object.  <a href="classumontreal_1_1ssj_1_1randvar_1_1RandomVariateGen.html#ad9cad3813799df7ee03accea2bb4d086">More...</a><br /></td></tr>
<tr class="separator:ad9cad3813799df7ee03accea2bb4d086 inherit pub_methods_classumontreal_1_1ssj_1_1randvar_1_1RandomVariateGen"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab19f393ef03e94ecc2f93bd36e3eaf6d inherit pub_methods_classumontreal_1_1ssj_1_1randvar_1_1RandomVariateGen"><td class="memItemLeft" align="right" valign="top"><a class="el" href="interfaceumontreal_1_1ssj_1_1rng_1_1RandomStream.html">RandomStream</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classumontreal_1_1ssj_1_1randvar_1_1RandomVariateGen.html#ab19f393ef03e94ecc2f93bd36e3eaf6d">getStream</a> ()</td></tr>
<tr class="memdesc:ab19f393ef03e94ecc2f93bd36e3eaf6d inherit pub_methods_classumontreal_1_1ssj_1_1randvar_1_1RandomVariateGen"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the <a class="el" href="interfaceumontreal_1_1ssj_1_1rng_1_1RandomStream.html">umontreal.ssj.rng.RandomStream</a> used by this generator.  <a href="classumontreal_1_1ssj_1_1randvar_1_1RandomVariateGen.html#ab19f393ef03e94ecc2f93bd36e3eaf6d">More...</a><br /></td></tr>
<tr class="separator:ab19f393ef03e94ecc2f93bd36e3eaf6d inherit pub_methods_classumontreal_1_1ssj_1_1randvar_1_1RandomVariateGen"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad096736436bd336c9b21860d1b7912ad inherit pub_methods_classumontreal_1_1ssj_1_1randvar_1_1RandomVariateGen"><td class="memItemLeft" align="right" valign="top"><a id="ad096736436bd336c9b21860d1b7912ad"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classumontreal_1_1ssj_1_1randvar_1_1RandomVariateGen.html#ad096736436bd336c9b21860d1b7912ad">setStream</a> (<a class="el" href="interfaceumontreal_1_1ssj_1_1rng_1_1RandomStream.html">RandomStream</a> stream)</td></tr>
<tr class="memdesc:ad096736436bd336c9b21860d1b7912ad inherit pub_methods_classumontreal_1_1ssj_1_1randvar_1_1RandomVariateGen"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the <a class="el" href="interfaceumontreal_1_1ssj_1_1rng_1_1RandomStream.html">umontreal.ssj.rng.RandomStream</a> used by this generator to <code>stream</code>. <br /></td></tr>
<tr class="separator:ad096736436bd336c9b21860d1b7912ad inherit pub_methods_classumontreal_1_1ssj_1_1randvar_1_1RandomVariateGen"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a63662dff34593365e34f3be64e23d09f inherit pub_methods_classumontreal_1_1ssj_1_1randvar_1_1RandomVariateGen"><td class="memItemLeft" align="right" valign="top"><a class="el" href="interfaceumontreal_1_1ssj_1_1probdist_1_1Distribution.html">Distribution</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classumontreal_1_1ssj_1_1randvar_1_1RandomVariateGen.html#a63662dff34593365e34f3be64e23d09f">getDistribution</a> ()</td></tr>
<tr class="memdesc:a63662dff34593365e34f3be64e23d09f inherit pub_methods_classumontreal_1_1ssj_1_1randvar_1_1RandomVariateGen"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the <a class="el" href="interfaceumontreal_1_1ssj_1_1probdist_1_1Distribution.html">umontreal.ssj.probdist.Distribution</a> used by this generator.  <a href="classumontreal_1_1ssj_1_1randvar_1_1RandomVariateGen.html#a63662dff34593365e34f3be64e23d09f">More...</a><br /></td></tr>
<tr class="separator:a63662dff34593365e34f3be64e23d09f inherit pub_methods_classumontreal_1_1ssj_1_1randvar_1_1RandomVariateGen"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad146fa8579a5f8a876c4688cc5a68520 inherit pub_methods_classumontreal_1_1ssj_1_1randvar_1_1RandomVariateGen"><td class="memItemLeft" align="right" valign="top"><a id="ad146fa8579a5f8a876c4688cc5a68520"></a>
String&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classumontreal_1_1ssj_1_1randvar_1_1RandomVariateGen.html#ad146fa8579a5f8a876c4688cc5a68520">toString</a> ()</td></tr>
<tr class="memdesc:ad146fa8579a5f8a876c4688cc5a68520 inherit pub_methods_classumontreal_1_1ssj_1_1randvar_1_1RandomVariateGen"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns a <code>String</code> containing information about the current generator. <br /></td></tr>
<tr class="separator:ad146fa8579a5f8a876c4688cc5a68520 inherit pub_methods_classumontreal_1_1ssj_1_1randvar_1_1RandomVariateGen"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:ad6606da776808a1a3419d7c9c4c0a631"><td class="memItemLeft" align="right" valign="top"><a id="ad6606da776808a1a3419d7c9c4c0a631"></a>
<a class="el" href="classumontreal_1_1ssj_1_1randvar_1_1RandomVariateGen.html">RandomVariateGen</a>&#160;</td><td class="memItemRight" valign="bottom"><b>kernelGen</b></td></tr>
<tr class="separator:ad6606da776808a1a3419d7c9c4c0a631"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a14628ead92d0afcce5f53e0ff017c8"><td class="memItemLeft" align="right" valign="top"><a id="a3a14628ead92d0afcce5f53e0ff017c8"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>bandwidth</b></td></tr>
<tr class="separator:a3a14628ead92d0afcce5f53e0ff017c8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a02132475daddb375b63922070fc65085"><td class="memItemLeft" align="right" valign="top"><a id="a02132475daddb375b63922070fc65085"></a>
boolean&#160;</td><td class="memItemRight" valign="bottom"><b>positive</b></td></tr>
<tr class="separator:a02132475daddb375b63922070fc65085"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_attribs_classumontreal_1_1ssj_1_1randvar_1_1RandomVariateGen"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_classumontreal_1_1ssj_1_1randvar_1_1RandomVariateGen')"><img src="closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="classumontreal_1_1ssj_1_1randvar_1_1RandomVariateGen.html">RandomVariateGen</a></td></tr>
<tr class="memitem:afb31f41143180aca0eede219faae5d4b inherit pro_attribs_classumontreal_1_1ssj_1_1randvar_1_1RandomVariateGen"><td class="memItemLeft" align="right" valign="top"><a id="afb31f41143180aca0eede219faae5d4b"></a>
<a class="el" href="interfaceumontreal_1_1ssj_1_1rng_1_1RandomStream.html">RandomStream</a>&#160;</td><td class="memItemRight" valign="bottom"><b>stream</b></td></tr>
<tr class="separator:afb31f41143180aca0eede219faae5d4b inherit pro_attribs_classumontreal_1_1ssj_1_1randvar_1_1RandomVariateGen"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a00522d4f2a080a3f95790bfd8b9822e7 inherit pro_attribs_classumontreal_1_1ssj_1_1randvar_1_1RandomVariateGen"><td class="memItemLeft" align="right" valign="top"><a id="a00522d4f2a080a3f95790bfd8b9822e7"></a>
<a class="el" href="interfaceumontreal_1_1ssj_1_1probdist_1_1Distribution.html">Distribution</a>&#160;</td><td class="memItemRight" valign="bottom"><b>dist</b></td></tr>
<tr class="separator:a00522d4f2a080a3f95790bfd8b9822e7 inherit pro_attribs_classumontreal_1_1ssj_1_1randvar_1_1RandomVariateGen"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="member-group"></a>
Kernel selection and parameters</h2></td></tr>
<tr class="memitem:a21f23c7c887c0bf0068dde483c1bc760"><td class="memItemLeft" align="right" valign="top"><a id="a21f23c7c887c0bf0068dde483c1bc760"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classumontreal_1_1ssj_1_1randvar_1_1KernelDensityGen.html#a21f23c7c887c0bf0068dde483c1bc760">setBandwidth</a> (double h)</td></tr>
<tr class="memdesc:a21f23c7c887c0bf0068dde483c1bc760"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the bandwidth to <code>h</code>. <br /></td></tr>
<tr class="separator:a21f23c7c887c0bf0068dde483c1bc760"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a71176146a17741255ec9fdd0c5799ea4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classumontreal_1_1ssj_1_1randvar_1_1KernelDensityGen.html#a71176146a17741255ec9fdd0c5799ea4">setPositiveReflection</a> (boolean reflect)</td></tr>
<tr class="memdesc:a71176146a17741255ec9fdd0c5799ea4"><td class="mdescLeft">&#160;</td><td class="mdescRight">After this method is called with <code>true</code>, the generator will produce only positive values, by using the <em>reflection method</em>: replace all negative values by their <em>absolute values</em>.  <a href="#a71176146a17741255ec9fdd0c5799ea4">More...</a><br /></td></tr>
<tr class="separator:a71176146a17741255ec9fdd0c5799ea4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8143b8bd8ccdea3248e4fc7867c1ab6"><td class="memItemLeft" align="right" valign="top"><a id="aa8143b8bd8ccdea3248e4fc7867c1ab6"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>nextDouble</b> ()</td></tr>
<tr class="separator:aa8143b8bd8ccdea3248e4fc7867c1ab6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f7d3ea911a2cc84bac6b1b888ad2c05"><td class="memItemLeft" align="right" valign="top"><a id="a3f7d3ea911a2cc84bac6b1b888ad2c05"></a>
static double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classumontreal_1_1ssj_1_1randvar_1_1KernelDensityGen.html#a3f7d3ea911a2cc84bac6b1b888ad2c05">getBaseBandwidth</a> (<a class="el" href="classumontreal_1_1ssj_1_1probdist_1_1EmpiricalDist.html">EmpiricalDist</a> dist)</td></tr>
<tr class="memdesc:a3f7d3ea911a2cc84bac6b1b888ad2c05"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes and returns the value of \(h_0\) in ( <a class="el" href="classumontreal_1_1ssj_1_1randvar_1_1KernelDensityGen.html#REF_randvar_KernelDensityGen_eq_bandwidth0">bandwidth0</a> ). <br /></td></tr>
<tr class="separator:a3f7d3ea911a2cc84bac6b1b888ad2c05"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This class implements random variate generators for distributions obtained via <em>kernel density estimation</em> methods from a set of \(n\) individual observations \(x_1,â€¦,x_n\) <a class="el" href="citelist.html#CITEREF_tDEV85a">[42]</a>, <a class="el" href="citelist.html#CITEREF_rDEV86a">[43]</a>, <a class="el" href="citelist.html#CITEREF_rHOR00a">[84]</a>, <a class="el" href="citelist.html#CITEREF_rHOR04a">[85]</a>, <a class="el" href="citelist.html#CITEREF_tSIL86a">[190]</a>&thinsp;. </p>
<p>The basic idea is to center a copy of the same symmetric density at each observation and take an equally weighted mixture of the \(n\) copies as an estimator of the density from which the observations come. The resulting kernel density has the general form </p><p class="formulaDsp">
\[ f_n(x) = \frac{1}{nh} \sum_{i=1}^n k((x-x_i)/h), \]
</p>
<p> where \(k\) is a fixed pre-selected density called the <em>kernel</em> and \(h\) is a positive constant called the <em>bandwidth</em> or <em>smoothing factor</em>. A difficult practical issue is the selection of \(k\) and \(h\). Several approaches have been proposed for that; see, e.g., <a class="el" href="citelist.html#CITEREF_tBER94a">[15]</a>, <a class="el" href="citelist.html#CITEREF_tCAO94a">[29]</a>, <a class="el" href="citelist.html#CITEREF_rHOR04a">[85]</a>, <a class="el" href="citelist.html#CITEREF_tSIL86a">[190]</a>&thinsp;.</p>
<p>The constructor of a generator from a kernel density requires a random stream \(s\), the \(n\) observations in the form of an empirical distribution, a random variate generator for the kernel density \(k\), and the value of the bandwidth \(h\). The random variates are then generated as follows: select an observation \(x_I\) at random, by inversion, using stream \(s\), then generate random variate \(Y\) with the generator provided for the density \(k\), and return \(x_I + hY\).</p>
<p>A simple formula for the bandwidth, suggested in <a class="el" href="citelist.html#CITEREF_tSIL86a">[190]</a>, <a class="el" href="citelist.html#CITEREF_rHOR04a">[85]</a>&thinsp;, is \(h = \alpha_k h_0\), where <a class="anchor" id="REF_randvar_KernelDensityGen_eq_bandwidth0"></a> </p><p class="formulaDsp">
\[ h_0 = 1.36374 \min(s_n, q / 1.34) n^{-1/5}, \tag{bandwidth0} \]
</p>
<p> \(s_n\) and \(q\) are the empirical standard deviation and the interquartile range of the \(n\) observations, and \(\alpha_k\) is a constant that depends on the type of kernel \(k\). It is defined by </p><p class="formulaDsp">
\[ \alpha_k = \left(\sigma_k^{-4} \int_{-\infty}^{\infty}k(x)dx \right)^{1/5} \]
</p>
<p> where \(\sigma_k\) is the standard deviation of the density \(k\). The static method <a class="el" href="classumontreal_1_1ssj_1_1randvar_1_1KernelDensityGen.html#a3f7d3ea911a2cc84bac6b1b888ad2c05" title="Computes and returns the value of  in ( bandwidth0 ). ">getBaseBandwidth</a> permits one to compute \(h_0\) for a given empirical distribution.</p>
<center> <center>Some suggested kernels</center><p> <a class="anchor" id="REF_randvar_KernelDensityGen_tab_kernels"></a></p><table class="SSJ-table SSJ-has-hlines">
<tr class="bt">
<td class="l">name </td><td class="l">constructor </td><td class="c">\(\alpha_k\) </td><td class="c">\(\sigma_k^2\) </td><td class="c">efficiency </td></tr>
<tr class="bt">
<td class="l">Epanechnikov </td><td class="l"><code>BetaSymmetricalDist(2, -1, 1)</code> </td><td class="c">1.7188 </td><td class="c">1/5 </td><td class="c">1.000 </td></tr>
<tr>
<td class="l">triangular </td><td class="l"><code>TriangularDist(-1, 1, 0)</code> </td><td class="c">1.8882 </td><td class="c">1/6 </td><td class="c">0.986 </td></tr>
<tr>
<td class="l">Gaussian </td><td class="l"><code>NormalDist()</code> </td><td class="c">0.7764 </td><td class="c">1 </td><td class="c">0.951 </td></tr>
<tr>
<td class="l">boxcar </td><td class="l"><code>UniformDist(-1, 1)</code> </td><td class="c">1.3510 </td><td class="c">1/3 </td><td class="c">0.930 </td></tr>
<tr>
<td class="l">logistic </td><td class="l"><code>LogisticDist()</code> </td><td class="c">0.4340 </td><td class="c">3.2899 </td><td class="c">0.888 </td></tr>
<tr>
<td class="l">Student-t(3) </td><td class="l"><code>StudentDist(3)</code> </td><td class="c">0.4802 </td><td class="c">3 </td><td class="c">0.674  </td></tr>
</table>
</center><center></center><p>Table&#160; <a class="el" href="classumontreal_1_1ssj_1_1randvar_1_1KernelDensityGen.html#REF_randvar_KernelDensityGen_tab_kernels">kernels</a> gives the precomputed values of \(\sigma_k\) and \(\alpha_k\) for selected (popular) kernels. The values are taken from <a class="el" href="citelist.html#CITEREF_rHOR04a">[85]</a>&thinsp;. The second column gives the name of a function (in this package) that constructs the corresponding distribution. The <em>efficiency</em> of a kernel is defined as the ratio of its mean integrated square error over that of the Epanechnikov kernel, which has optimal efficiency and corresponds to the beta distribution with parameters \((2,2)\) over the interval \((-1,1)\).</p>
<div class="SSJ-bigskip"></div> </div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="aa798ef01a79e43917669d37de148343c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa798ef01a79e43917669d37de148343c">&#9670;&nbsp;</a></span>KernelDensityGen()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classumontreal_1_1ssj_1_1randvar_1_1KernelDensityGen.html">KernelDensityGen</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="interfaceumontreal_1_1ssj_1_1rng_1_1RandomStream.html">RandomStream</a>&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classumontreal_1_1ssj_1_1probdist_1_1EmpiricalDist.html">EmpiricalDist</a>&#160;</td>
          <td class="paramname"><em>dist</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classumontreal_1_1ssj_1_1randvar_1_1NormalGen.html">NormalGen</a>&#160;</td>
          <td class="paramname"><em>kGen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This constructor uses a gaussian kernel and the default bandwidth \(h = \alpha_k h_0\) with the \(\alpha_k\) suggested in Table&#160; <a class="el" href="classumontreal_1_1ssj_1_1randvar_1_1KernelDensityGen.html#REF_randvar_KernelDensityGen_tab_kernels">kernels</a> for the gaussian distribution. </p>
<p>This kernel has an efficiency of 0.951. </p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a71176146a17741255ec9fdd0c5799ea4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a71176146a17741255ec9fdd0c5799ea4">&#9670;&nbsp;</a></span>setPositiveReflection()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void setPositiveReflection </td>
          <td>(</td>
          <td class="paramtype">boolean&#160;</td>
          <td class="paramname"><em>reflect</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>After this method is called with <code>true</code>, the generator will produce only positive values, by using the <em>reflection method</em>: replace all negative values by their <em>absolute values</em>. </p>
<p>That is, #nextDouble will return \(|x|\) if \(x\) is the generated variate. The mecanism is disabled when the method is called with <code>false</code>. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>KernelDensityGen.java</li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
