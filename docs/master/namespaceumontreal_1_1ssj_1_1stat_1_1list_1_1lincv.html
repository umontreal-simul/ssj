<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.8"/>
<title>SSJ: umontreal::ssj::stat::list::lincv Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
MathJax.Hub.Config({
  tex2jax: {
    skipTags: ["script","noscript","style","textarea","pre"]
  }
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="ssj.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">SSJ
   &#160;<span id="projectnumber">3.2.0</span>
   </div>
   <div id="projectbrief">Stochastic Simulation in Java</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.8 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li class="current"><a href="namespaces.html"><span>Packages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="namespaces.html"><span>Packages</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><b>umontreal</b></li><li class="navelem"><b>ssj</b></li><li class="navelem"><a class="el" href="namespaceumontreal_1_1ssj_1_1stat.html">stat</a></li><li class="navelem"><a class="el" href="namespaceumontreal_1_1ssj_1_1stat_1_1list.html">list</a></li><li class="navelem"><a class="el" href="namespaceumontreal_1_1ssj_1_1stat_1_1list_1_1lincv.html">lincv</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a>  </div>
  <div class="headertitle">
<div class="title">umontreal::ssj::stat::list::lincv Namespace Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classumontreal_1_1ssj_1_1stat_1_1list_1_1lincv_1_1FunctionOfMultipleMeansTallyWithCV.html">FunctionOfMultipleMeansTallyWithCV</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Represents a function of multiple means tally for an estimator with linear control variables.  <a href="classumontreal_1_1ssj_1_1stat_1_1list_1_1lincv_1_1FunctionOfMultipleMeansTallyWithCV.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classumontreal_1_1ssj_1_1stat_1_1list_1_1lincv_1_1ListOfTalliesWithCV_3_01E_01extends_01Tally_01_4.html">ListOfTalliesWithCV&lt; E extends Tally &gt;</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Represents a list of tallies with control variables that inherits the functionalities of a list of tallies, and accepts vectors of length \(p+q\).  <a href="classumontreal_1_1ssj_1_1stat_1_1list_1_1lincv_1_1ListOfTalliesWithCV_3_01E_01extends_01Tally_01_4.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p><a class="anchor" id="REF_stat_list_lincv_overview_over_licv_tal"></a>Provides facilities for computing estimators with linear control variables <a class="el" href="citelist.html#CITEREF_vLAV81a">[106]</a>, <a class="el" href="citelist.html#CITEREF_vGLY02a">[66]</a>&thinsp;. Let \(\mathbf{X}\in\mathbb{R}^p\) be a vector of estimators, and \(\mathbf{C}\in\mathbb{R}^q\) be a vector of <em>control variables</em> with known expectation \(E[\mathbf{C}]\). The estimator \(\mathbf{X}\) can be replaced by the linearly controlled estimator </p><p class="formulaDsp">
\[ \mathbf{X}_{\mathrm{C}}=\mathbf{X}- \boldsymbol{\beta}^{\mathsf{t}}(\mathbf{C}- E[\mathbf{C}]), \]
</p>
<p> where \(\boldsymbol{\beta}\) is a constant \(q\times p\) matrix. The covariance matrix of this estimator is </p><p class="formulaDsp">
\[ \mathrm{Cov}(\mathbf{X}_{\mathrm{C}}) = \boldsymbol{\Sigma}_{\mathrm{X}}+ \boldsymbol{\beta}^{\mathsf{t}}\boldsymbol{\Sigma}_{\mathrm{C}}\boldsymbol{\beta}- \boldsymbol{\beta}^{\mathsf{t}}\boldsymbol{\Sigma}_{\mathrm{CX}}- \boldsymbol{\Sigma}_{\mathrm{CX}}^{\mathsf{t}}\boldsymbol{\beta}, \]
</p>
<p> where \(\boldsymbol{\Sigma}_{\mathrm{CX}}\) is the \(q\times p\) covariance matrix of \(\mathbf{C}\) and \(\mathbf{X}\), \(\boldsymbol{\Sigma}_{\mathrm{C}}\) is the \(q\times q\) covariance matrix of \(\mathbf{C}\), and \(\boldsymbol{\Sigma}_{\mathrm{X}}\) is the \(p\times p\) covariance matrix of \(\mathbf{X}\). The matrix \(\boldsymbol{\beta}\) can be set for \(|\mathrm{Cov}(\mathbf{X}_{\mathrm{C}})|\le|\mathrm{Cov}(\mathbf{X})|\), where \(|\boldsymbol{\Sigma}|\) is the determinant of the matrix \(\boldsymbol{\Sigma}\). The optimal \(\boldsymbol{\beta}\) matrix, which minimizes the determinant (or the trace) of the covariance matrix, is </p><p class="formulaDsp">
\[ \boldsymbol{\beta}^* = \boldsymbol{\Sigma}_{\mathrm{C}}^{-1}\boldsymbol{\Sigma}_{\mathrm{CX}}. \]
</p>
<p> If \(\boldsymbol{\mu}=E[\mathbf{X}]\), \(\boldsymbol{\nu}=E[\mathbf{C}]\), and \(g(\boldsymbol{\mu})\) is a continuous function in the neighborhood of \(\boldsymbol{\mu}\), let \(h(\boldsymbol{\mu}, \boldsymbol{\nu})=g(\boldsymbol{\mu})-\boldsymbol{\beta}_{\mathrm{f}}^{\mathsf{t}}(\mathbf{C}- \boldsymbol{\nu})\) be the corresponding function with control variables. Here, \(\boldsymbol{\beta}_{\mathrm{f}}\) is a \(q\)-dimensional vector being set to reduce the variance of the function of averages with control variables. The optimal \(\boldsymbol{\beta}_{\mathrm{f}}\) vector that minimizes the variance is </p><p class="formulaDsp">
\[ \boldsymbol{\beta}_{\mathrm{f}}^* = \boldsymbol{\beta}^*\nabla g(\boldsymbol{\mu}) = \boldsymbol{\Sigma}_{\mathrm{C}}^{-1}\boldsymbol{\Sigma}_{\mathrm{CX}}\nabla g(\boldsymbol{\mu}). \]
</p>
<p> This package provides classes that can help one implement such control variables. During the simulation, or during pilot runs, one adds observations of the estimators and the control variables to a list of tallies specialized for control variables. This list computes the covariances, and can compute an estimate of \(\boldsymbol{\beta}^*\) by using matrices of sample covariances. The vector of controlled averages, and the sample controlled covariance matrix can then be obtained. Alternatively, one can reset the list of tallies, keep the \(\boldsymbol{\beta}\) matrix, and add independent vectors of observations.</p>
<p>The package also provides a class for applying control variables on a function of multiple averages. A tally for a function of multiple means with control variables encapsulates a list of tallies with control variables, and an object computing \(g(\boldsymbol{\mu})\) and its gradient \(\nabla g(\boldsymbol{\mu})\). A method is available to estimate the \(\boldsymbol{\beta}_{\mathrm{f}}\) vector minimizing the variance of the function of averages. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.8
</small></address>
</body>
</html>
